{"Name":"Form Extract","RelativePathFolderName":"","FormName":"Form Extract","DepartmentName":"Fiscal Admin","FormDefinitionGuid":"e8df741a-9b3c-4ba1-ab8d-8ef773d7da7c","DeparmentGuid":"ca6c633d-3b71-480f-a8b5-e02afe84ae0b","Html":"","Script":"","ClientSideScript":"function ClientScript_OnAfterRender(form) {\r\n    form.on(\"change\", function(event) {      \r\n        if (event.changed && event.changed.component.key === \"rdoResident1_NotForReporting\") {\r\n            form.getComponent(\"rdoResident2_NotForReporting\").setValue(\"\");\r\n\r\n            form.getComponent(\"rdoResident\").setValue(event.changed.value);\r\n        } \r\n\r\n        if (event.changed && event.changed.component.key === \"rdoResident2_NotForReporting\") {\r\n            form.getComponent(\"rdoResident1_NotForReporting\").setValue(\"\");\r\n\r\n            form.getComponent(\"rdoResident\").setValue(event.changed.value);\r\n        } \r\n    });\r\n}","ServerSideScript":"Class FormScriptEvents\r\nprivate sub OnCreate()\r\n\r\nend sub\r\nprivate sub OnLoad()\r\n    clearFields()\r\n    theForm(\"txtaDebug\") = \"\"\r\n    theForm(\"txtaGenerateError\") = \"\"\r\nend sub\r\nprivate sub OnSave()\r\n    if theForm(\"chkGenerateBilling\") then\r\n        select case theForm(\"cmbProgram\")\r\n            case \"Community Residential\"\r\n                'run the extract for Community Residential\r\n                createCRAppts()\r\n            case \"Community Residential - Room & Board\"\r\n                'code for case 2\r\n                createCRRBAppts()\r\n            case \"Intermediate Care Facilities\"\r\n                'code for case 3\r\n                theForm(\"txtaGenerateError\") = \"<font color='red'>No billing records were created, not yet configured</font>\"\r\n        end select\r\n    \r\n        theForm(\"chkGenerateBilling\") = false\r\n    end if\r\nend sub\r\nprivate sub clearFields()\r\n    theForm(\"cmbMonth\") = \"\"\r\n    theForm(\"cmbYear\") = \"\"\r\n    theForm(\"cmbInclude\") = \"\"\r\n    theForm(\"cmbExclude\") = \"\"\r\n    theForm(\"rdoResident1_NotForReporting\") = \"\"\r\n    theForm(\"rdoResident2_NotForReporting\") = \"\"\r\n    theForm(\"rdoResident\") = \"\"\r\n    theForm(\"cmbProgram\") = \"\"\r\nend sub\r\nprivate sub createCRAppts()\r\n    resType = \"\"\r\n    residents = \"\"\r\n    if theForm(\"rdoResident\") = \"All residents active during the billing period\" then\r\n        resType = \"All\"\r\n    elseif theForm(\"rdoResident\") = \"Only include the residents selected below\" then\r\n        resType = \"Include\"\r\n        residents = theForm(\"cmbInclude\")\r\n    elseif theForm(\"rdoResident\") = \"Exclude the residents selected below\" then\r\n        resType = \"Exclude\"\r\n        residents = theForm(\"cmbExclude\")\r\n    end if\r\n\r\n    'both queries make sure that they don't create duplicate reports\r\n    eligible = theForm.execSQL(\"exec [cstm_fiscal admin_CR Form Extract_getValidDays] @month = '\" & theForm(\"cmbMonth\") & \"', @year = '\" & theForm(\"cmbYear\") & \"', @resType = '\" & resType & \"', @residents = '\" & residents & \"'\")\r\n    ineligible = theForm.execSQL(\"exec [cstm_fiscal admin_CR Form Extract_getIneligibleDays] @month = '\" & theForm(\"cmbMonth\") & \"', @year = '\" & theForm(\"cmbYear\") & \"', @resType = '\" & resType & \"', @residents = '\" & residents & \"'\")\r\n    createString = \"\"\r\n    user = theForm.User.UserGUID.tostring()\r\n    fig = theForm.FormInstanceGUID.tostring()\r\n    owner = theForm.DataStore.OwnerObjectGUID.tostring()\r\n\r\n    if eligible.Rows.Count > 0 then\r\n        for x = 0 to eligible.Rows.Count - 1\r\n            startDT = eligible.Rows(x).Item(\"startDT\")\r\n            endDT = eligible.Rows(x).Item(\"endDT\")\r\n            actGUID = eligible.Rows(x).Item(\"ActivityGUID\")\r\n            progGUID = eligible.Rows(x).Item(\"costCenterGUID\")\r\n            locGUID = eligible.Rows(x).Item(\"LocationGUID\")\r\n            residentGUID = eligible.Rows(x).Item(\"residentGUID\")\r\n            'user = theForm.User.UserGUID.tostring()\r\n            'fig = theForm.FormInstanceGUID.tostring()\r\n            expense = \"00000000-0000-0000-0000-000000000000\"\r\n\r\n            apptGUID = theForm.CreateAcctAppointment(startDT, endDT, actGUID, progGUID, locGUID, residentGUID, user, fig, expense)\r\n\r\n            theForm(\"txtaDebug\") = theForm(\"txtaDebug\") & vbnewline & \"eligible row: \" & x + 1 & \" was executed, apptguid: \" & apptGUID\r\n        next\r\n\r\n        createString = createString & \"<font color='blue'>All eligible records for contacts were created successfully.</font>\" & vbnewline\r\n\r\n        siteLogMessage = \"CR Form Extract Completed - With/Without Day\"\r\n        siteLogMonthAndYearInfo = \"Extracted for \" & theForm(\"cmbMonth\") & \"/\" & theForm(\"cmbYear\")\r\n        theForm.LogSomething user, \"41\", owner, fig, siteLogMessage, siteLogMonthAndYearInfo, \"\", \"\", \"\"\r\n    else\r\n        createString = createString & \"<font color='red'>All eligible records for contacts have been made for selected month and year (\" & theForm(\"cmbMonth\") & \"/\" & theForm(\"cmbYear\") & \").</font>\" & vbnewline\r\n    end if\r\n\r\n    if ineligible.Rows.Count > 0 then\r\n        for x = 0 to ineligible.Rows.Count - 1\r\n            startDT = ineligible.Rows(x).Item(\"startDT\")\r\n            endDT = ineligible.Rows(x).Item(\"endDT\")\r\n            actGUID = ineligible.Rows(x).Item(\"ActivityGUID\")\r\n            progGUID = ineligible.Rows(x).Item(\"costCenterGUID\")\r\n            locGUID = ineligible.Rows(x).Item(\"LocationGUID\")\r\n            residentGUID = ineligible.Rows(x).Item(\"residentGUID\")\r\n            'user = theForm.User.UserGUID.tostring()\r\n            'fig = theForm.FormInstanceGUID.tostring()\r\n            expense = \"00000000-0000-0000-0000-000000000000\"\r\n\r\n            apptGUID = theForm.CreateAcctAppointment(startDT, endDT, actGUID, progGUID, locGUID, residentGUID, user, fig, expense)\r\n\r\n            theForm(\"txtaDebug\") = theForm(\"txtaDebug\") & vbnewline & \"ineligible row: \" & x + 1 & \" was executed, apptguid: \" & apptGUID\r\n        next\r\n\r\n        createString = createString & \"<font color='blue'>All ineligible records for contacts were created successfully.</font>\" & vbnewline\r\n\r\n        siteLogMessage = \"CR Form Extract Completed - Ineligible\"\r\n        siteLogMonthAndYearInfo = \"Extracted for \" & theForm(\"cmbMonth\") & \"/\" & theForm(\"cmbYear\")\r\n        theForm.LogSomething user, \"41\", owner, fig, siteLogMessage, siteLogMonthAndYearInfo, \"\", \"\", \"\"\r\n    else\r\n        createString = createString & \"<font color='red'>All ineligible records for contacts have been made for selected month and year (\" & theForm(\"cmbMonth\") & \"/\" & theForm(\"cmbYear\") & \").</font>\" & vbnewline\r\n    end if\r\n\r\n    theForm(\"txtaGenerateError\") = createString\r\n    clearFields()\r\nend sub\r\nprivate sub createCRRBAppts()\r\n    resType = \"\"\r\n    residents = \"\"\r\n    if theForm(\"rdoResident\") = \"All residents active during the billing period\" then\r\n        resType = \"All\"\r\n    elseif theForm(\"rdoResident\") = \"Only include the residents selected below\" then\r\n        resType = \"Include\"\r\n        residents = theForm(\"cmbInclude\")\r\n    elseif theForm(\"rdoResident\") = \"Exclude the residents selected below\" then\r\n        resType = \"Exclude\"\r\n        residents = theForm(\"cmbExclude\")\r\n    end if\r\n\r\n    apptGUID = \"\"\r\n    startDt = \"\"\r\n    endDt = \"\"\r\n    activityGUID = theForm.execScalerSQL(\"select top 1 cast(ActivityGUID as varchar(36)) from Activity where ActivityName = 'Community Residential Room & Board'\")\r\n    programGUID = \"\" 'this is their placement location\r\n    locationGUID = theForm.execScalerSQL(\"select top 1 cast(LocationGUID as varchar(36)) from [Location] where LocationName = 'Group Home'\")\r\n    residentGUID = \"\"\r\n    staffGUID = theForm.User.UserGUID.tostring()\r\n    dur = 0\r\n    imperfect = \"\"\r\n\r\n    expenseGUID = theForm.execScalerSQL(\"select top 1 cast(ExpenseGuid as varchar(36)) from Expense where ExpenseName = 'Community Residential Room & Board'\")\r\n    \r\n    cons = theForm.execSQL(\"exec [cstm_fiscal admin_CR R&B Form Extract_Get Contacts for Appt Creation] @month = '\" & theForm(\"cmbMonth\") & \"', @year = '\" & theForm(\"cmbYear\") & \"', @resType = '\" & resType & \"', @residents = '\" & residents & \"'\")\r\n    if cons.Columns.Count > 0 then\r\n        for x = 0 to cons.Rows.Count - 1\r\n            'for each contact and placement they have, create an acctappt record\r\n            startDt = cons.Rows(x).Item(\"placeStart\")\r\n            endDt = cons.Rows(x).Item(\"placeEnd\")\r\n            programGUID = cons.Rows(x).Item(\"placeLoc\")\r\n            residentGUID = cons.Rows(x).Item(\"residentGUID\")\r\n\r\n            'will return as true if the billing month is imperfect in some way\r\n            'a special calculation for duration will need to run if the proc returns as true\r\n            imperfect = theForm.execScalerSQL(\"exec [cstm_fiscal admin_CR R&B Form Extract_Get Unbillable Status] @month = '\" & theForm(\"cmbMonth\") & \"', @year = '\" & theForm(\"cmbYear\") & \"', @contact = '\" & cons.Rows(x).Item(\"residentGUID\") & \"', @rowGUID = '\" & cons.Rows(x).Item(\"RowGUID\") & \"'\")\r\n\r\n            if imperfect = \"true\" then\r\n                dur = theForm.execScalerSQL(\"exec [cstm_fiscal admin_CR R&B Form Extract_Get Final Amount] @month = '\" & theForm(\"cmbMonth\") & \"', @year = '\" & theForm(\"cmbYear\") & \"', @contact = '\" & cons.Rows(x).Item(\"residentGUID\") & \"', @rowGUID = '\" & cons.Rows(x).Item(\"RowGUID\") & \"'\")\r\n            else\r\n                'this is for a \"perfect\" month, where there are no exceptions to mess up the charge\r\n                dur = theForm.execScalerSQL(\"select top 1 cast(main.numberAmountPaid as varchar(100)) as amt \" & _\r\n                                                \"from [ct_Consents and Acknowledgements_Room & Board Contracts-ICF & CLA] parent \" & _\r\n                                                \"join [ct_Consents and Acknowledgements_Room & Board Contracts-ICF & CLA_formgrid_Contract] link on parent.__forminstanceguid = link.__forminstanceguid \" & _\r\n                                                \"join [ct_Consents and Acknowledgements_Room & Board Contract-ICF & CLA] main on link.[view] = main.__forminstanceguid \" & _\r\n                                                \"where cast(main.__ownerobjectguid as varchar(36)) = '\" & cons.Rows(x).Item(\"residentGUID\") & \"' \" & _\r\n                                                \"order by cast(main.txtEffectiveDate as date) desc\")\r\n            end if\r\n\r\n            'create the appointment with John's function for creation that includes duration since we need to specially set it\r\n            'this sets all 3 fields of duration, charge, and client liability, instead of showing bad values for the last two from the original duration\r\n            apptGUID = theForm.CreateAcctAppointmentWithDuration(startDt, endDt, activityGUID, programGUID, locationGUID, residentGUID, staffGUID, dur, theForm.FormInstanceGUID.tostring(), expenseGUID)\r\n        next\r\n    end if\r\n\r\n    theForm(\"cmbMonth\") = \"\"\r\n    theForm(\"cmbYear\") = \"\"\r\n    theForm(\"cmbInclude\") = \"\"\r\n    theForm(\"cmbExclude\") = \"\"\r\n    theForm(\"rdoResident1_NotForReporting\") = \"\"\r\n    theForm(\"rdoResident2_NotForReporting\") = \"\"\r\n    theForm(\"rdoResident\") = \"\"\r\nend sub\r\nEnd Class","CSS":"","FormioTemplate":"{\"Grid\":{},\"components\":[{\"label\":\"pnlHidden\",\"title\":\"pnlHidden\",\"theme\":\"default\",\"breadcrumb\":\"default\",\"breadcrumbClickable\":true,\"allowPrevious\":false,\"buttonSettings\":{\"previous\":true,\"cancel\":true,\"next\":true},\"tooltip\":\"\",\"customClass\":\"\",\"tabindex\":\"\",\"collapsible\":false,\"collapsed\":false,\"hidden\":true,\"hideLabel\":false,\"dataGridLabel\":false,\"disabled\":true,\"modalEdit\":false,\"key\":\"pnlHidden\",\"tags\":[],\"properties\":{},\"customConditional\":\"\",\"conditional\":{\"json\":\"\",\"show\":null,\"when\":null,\"eq\":\"\"},\"nextPage\":\"\",\"logic\":[],\"attributes\":{},\"overlay\":{\"style\":\"\",\"page\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"type\":\"panel\",\"input\":false,\"tableView\":false,\"components\":[{\"label\":\"Columns\",\"columns\":[{\"components\":[{\"label\":\"txtaDebug\",\"inputMasks\":[{\"label\":\"\",\"mask\":\"\"}],\"tableView\":true,\"attributes\":{\"maxLength\":\"-1\"},\"key\":\"txtaDebug\",\"type\":\"textarea\",\"input\":true,\"KEY\":\"txtaDebug\",\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":{\"type\":\"input\"},\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false,\"minLength\":\"\",\"maxLength\":\"\",\"pattern\":\"\",\"minWords\":\"\",\"maxWords\":\"\"},\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"mask\":false,\"inputType\":\"text\",\"inputFormat\":\"plain\",\"inputMask\":\"\",\"spellcheck\":true,\"rows\":3,\"wysiwyg\":false,\"editor\":\"\",\"fixedSize\":true,\"id\":\"egivnnk\"}],\"width\":6,\"offset\":0,\"push\":0,\"pull\":0,\"size\":\"md\"},{\"components\":[{\"label\":\"rdoResident\",\"optionsLabelPosition\":\"right\",\"inline\":false,\"tableView\":false,\"values\":[{\"label\":\"All residents active during the billing period\",\"value\":\"All residents active during the billing period\",\"shortcut\":\"\"},{\"label\":\"Only include the residents selected below\",\"value\":\"Only include the residents selected below\",\"shortcut\":\"\"},{\"label\":\"Exclude the residents selected below\",\"value\":\"Exclude the residents selected below\",\"shortcut\":\"\"}],\"validate\":{\"onlyAvailableItems\":false,\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"key\":\"rdoResident\",\"type\":\"radio\",\"input\":true,\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"attributes\":{},\"validateOn\":\"change\",\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"inputType\":\"radio\",\"fieldSet\":false,\"id\":\"eyob6ei\"},{\"label\":\"chkGenerateBilling\",\"tableView\":false,\"key\":\"chkGenerateBilling\",\"type\":\"checkbox\",\"input\":true,\"KEY\":\"chkGenerateBilling\",\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":true,\"labelPosition\":\"right\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"attributes\":{},\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"inputType\":\"checkbox\",\"value\":\"\",\"name\":\"\",\"id\":\"eubrv6h\"}],\"width\":6,\"offset\":0,\"push\":0,\"pull\":0,\"size\":\"md\"}],\"key\":\"columns1\",\"type\":\"columns\",\"input\":false,\"tableView\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":false,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"attributes\":{},\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"tree\":false,\"autoAdjust\":false,\"hideOnChildrenHidden\":false,\"id\":\"erb084z\"}],\"placeholder\":\"\",\"prefix\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"allowMultipleMasks\":false,\"tree\":false,\"id\":\"egjbrmm\"},{\"label\":\"pnlMain\",\"title\":\"pnlMain\",\"theme\":\"default\",\"breadcrumb\":\"default\",\"breadcrumbClickable\":true,\"allowPrevious\":false,\"buttonSettings\":{\"previous\":true,\"cancel\":true,\"next\":true},\"tooltip\":\"\",\"customClass\":\"\",\"tabindex\":\"\",\"collapsible\":false,\"collapsed\":false,\"hidden\":false,\"hideLabel\":true,\"dataGridLabel\":false,\"disabled\":false,\"modalEdit\":false,\"key\":\"pnlMain\",\"tags\":[],\"properties\":{},\"customConditional\":\"\",\"conditional\":{\"json\":\"\",\"show\":null,\"when\":null,\"eq\":\"\"},\"nextPage\":\"\",\"logic\":[],\"attributes\":{},\"overlay\":{\"style\":\"\",\"page\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"type\":\"panel\",\"input\":false,\"tableView\":false,\"components\":[{\"label\":\"Columns\",\"columns\":[{\"components\":[{\"label\":\"Select the program for which you would like to extract billing records:\",\"labelPosition\":\"top\",\"widget\":\"html5\",\"placeholder\":\"\",\"description\":\"\",\"tooltip\":\"\",\"customClass\":\"\",\"tabindex\":\"\",\"hidden\":false,\"hideLabel\":false,\"uniqueOptions\":false,\"autofocus\":false,\"dataGridLabel\":false,\"disabled\":false,\"tableView\":true,\"modalEdit\":false,\"multiple\":false,\"dataSrc\":\"values\",\"indexeddb\":{\"database\":\"\",\"table\":\"\",\"filter\":{}},\"data\":{\"json\":\"\",\"url\":\"\",\"values\":[{\"label\":\"Community Residential\",\"value\":\"Community Residential\"},{\"label\":\"Community Residential - Room & Board\",\"value\":\"Community Residential - Room & Board\"},{\"label\":\"Intermediate Care Facilities\",\"value\":\"Intermediate Care Facilities\"}],\"resource\":\"\",\"headers\":[{\"key\":\"\",\"value\":\"\"}],\"custom\":\"\"},\"lazyLoad\":true,\"valueProperty\":\"\",\"selectValues\":\"\",\"dataType\":\"\",\"idPath\":\"id\",\"selectFields\":\"\",\"disableLimit\":false,\"searchField\":\"\",\"minSearch\":0,\"filter\":\"\",\"sort\":\"\",\"limit\":100,\"template\":\"<span>{{ item.label }}</span>\",\"refreshOn\":\"\",\"refreshOnBlur\":\"\",\"clearOnRefresh\":false,\"searchEnabled\":true,\"selectThreshold\":0.3,\"addResource\":false,\"addResourceLabel\":\"\",\"reference\":false,\"authenticate\":false,\"readOnlyValue\":false,\"customOptions\":{},\"useExactSearch\":false,\"ignoreCache\":false,\"redrawOn\":\"\",\"clearOnHide\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"validateOn\":\"change\",\"validate\":{\"required\":false,\"select\":false,\"onlyAvailableItems\":false,\"customMessage\":\"\",\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"errorLabel\":\"\",\"customConditional\":\"\",\"conditional\":{\"json\":\"\",\"show\":null,\"when\":null,\"eq\":\"\"},\"logic\":[],\"attributes\":{\"maxLength\":\"36\"},\"key\":\"cmbProgram\",\"onCreateDatasetKey\":\"\",\"onLoadDatasetKey\":\"\",\"QuoteValuesLegacy\":false,\"ListSource\":\"\",\"SQLSource\":\"\",\"type\":\"select\",\"inputMasks\":[{\"label\":\"\",\"mask\":\"\"}],\"input\":true,\"KEY\":\"cmbProgram\",\"hideOnChildrenHidden\":false,\"mask\":false,\"inputType\":\"text\",\"inputFormat\":\"plain\",\"spellcheck\":true,\"prefix\":\"\",\"suffix\":\"\",\"protected\":false,\"unique\":false,\"persistent\":true,\"dbIndex\":false,\"calculateServer\":false,\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"searchThreshold\":0.3,\"fuseOptions\":{\"include\":\"score\",\"threshold\":0.3},\"id\":\"eoxbet\",\"defaultValue\":\"\"},{\"label\":\"\",\"legend\":\"\",\"tooltip\":\"\",\"customClass\":\"pnlMain\",\"tabindex\":\"\",\"hidden\":false,\"dataGridLabel\":false,\"disabled\":false,\"modalEdit\":false,\"key\":\"fieldset\",\"tags\":[],\"properties\":{},\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\",\"json\":\"\"},\"customConditional\":\"if(data.cmbProgram === \\\"\\\" || data.cmbProgram === null) {\\r\\n  $('.pnlMain').hide();\\r\\n} else {\\r\\n  $('.pnlMain').show();\\r\\n}\\r\\n\",\"logic\":[],\"attributes\":{},\"overlay\":{\"style\":\"\",\"page\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"type\":\"fieldset\",\"input\":false,\"tableView\":false,\"components\":[{\"label\":\"Month for which to generate billing:\",\"labelPosition\":\"left-left\",\"widget\":\"html5\",\"tableView\":true,\"indexeddb\":{\"database\":\"\",\"table\":\"\",\"filter\":{}},\"data\":{\"values\":[{\"label\":\"January\",\"value\":\"1\"},{\"label\":\"February\",\"value\":\"2\"},{\"label\":\"March\",\"value\":\"3\"},{\"label\":\"April\",\"value\":\"4\"},{\"label\":\"May\",\"value\":\"5\"},{\"label\":\"June\",\"value\":\"6\"},{\"label\":\"July\",\"value\":\"7\"},{\"label\":\"August\",\"value\":\"8\"},{\"label\":\"September\",\"value\":\"9\"},{\"label\":\"October\",\"value\":\"10\"},{\"label\":\"November\",\"value\":\"11\"},{\"label\":\"December\",\"value\":\"12\"}],\"headers\":[{\"key\":\"\",\"value\":\"\"}],\"json\":\"\",\"url\":\"\",\"resource\":\"\",\"custom\":\"\"},\"disableLimit\":false,\"selectThreshold\":0.3,\"addResource\":false,\"reference\":false,\"validate\":{\"select\":false,\"onlyAvailableItems\":false,\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"attributes\":{\"maxLength\":\"15\"},\"key\":\"cmbMonth\",\"QuoteValuesLegacy\":false,\"type\":\"select\",\"labelWidth\":40,\"inputMasks\":[{\"label\":\"\",\"mask\":\"\"}],\"input\":true,\"KEY\":\"cmbMonth\",\"hideOnChildrenHidden\":false,\"mask\":false,\"inputType\":\"text\",\"inputFormat\":\"plain\",\"spellcheck\":true,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"validateOn\":\"change\",\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"idPath\":\"id\",\"clearOnRefresh\":false,\"limit\":100,\"dataSrc\":\"values\",\"valueProperty\":\"\",\"lazyLoad\":true,\"filter\":\"\",\"searchEnabled\":true,\"searchField\":\"\",\"minSearch\":0,\"readOnlyValue\":false,\"authenticate\":false,\"ignoreCache\":false,\"template\":\"<span>{{ item.label }}</span>\",\"selectFields\":\"\",\"searchThreshold\":0.3,\"uniqueOptions\":false,\"fuseOptions\":{\"include\":\"score\",\"threshold\":0.3},\"customOptions\":{},\"useExactSearch\":false,\"id\":\"epm9khq\"},{\"label\":\"Year for which to generate billing:\",\"labelPosition\":\"left-left\",\"widget\":\"html5\",\"tableView\":true,\"indexeddb\":{\"database\":\"\",\"table\":\"\",\"filter\":{}},\"data\":{\"values\":[{\"label\":\"\",\"value\":\"\"}],\"headers\":[{\"key\":\"\",\"value\":\"\"}],\"json\":\"\",\"url\":\"\",\"resource\":\"\",\"custom\":\"\"},\"disableLimit\":false,\"selectThreshold\":0.3,\"addResource\":false,\"reference\":false,\"validate\":{\"select\":false,\"onlyAvailableItems\":false,\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"attributes\":{\"maxLength\":\"4\"},\"key\":\"cmbYear\",\"QuoteValuesLegacy\":false,\"SQLSource\":\"exec cstm_GetYears @StartYear = 2025, @EndYear = 2040\",\"type\":\"select\",\"inputMasks\":[{\"label\":\"\",\"mask\":\"\"}],\"input\":true,\"KEY\":\"cmbYear\",\"hideOnChildrenHidden\":false,\"mask\":false,\"inputType\":\"text\",\"inputFormat\":\"plain\",\"spellcheck\":true,\"labelWidth\":40,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"validateOn\":\"change\",\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"idPath\":\"id\",\"clearOnRefresh\":false,\"limit\":100,\"dataSrc\":\"values\",\"valueProperty\":\"\",\"lazyLoad\":true,\"filter\":\"\",\"searchEnabled\":true,\"searchField\":\"\",\"minSearch\":0,\"readOnlyValue\":false,\"authenticate\":false,\"ignoreCache\":false,\"template\":\"<span>{{ item.label }}</span>\",\"selectFields\":\"\",\"searchThreshold\":0.3,\"uniqueOptions\":false,\"fuseOptions\":{\"include\":\"score\",\"threshold\":0.3},\"customOptions\":{},\"useExactSearch\":false,\"id\":\"ey81w4v\"},{\"label\":\"Residents to include:\",\"optionsLabelPosition\":\"right\",\"inline\":false,\"tableView\":false,\"values\":[{\"label\":\"All residents active during the billing period\",\"value\":\"All residents active during the billing period\",\"shortcut\":\"\"},{\"label\":\"Only include the residents selected below\",\"value\":\"Only include the residents selected below\",\"shortcut\":\"\"}],\"validate\":{\"onlyAvailableItems\":false,\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"key\":\"rdoResident1_NotForReporting\",\"type\":\"radio\",\"input\":true,\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"attributes\":{},\"validateOn\":\"change\",\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"inputType\":\"radio\",\"fieldSet\":false,\"id\":\"euc8uop\"},{\"label\":\"cmbInclude\",\"widget\":\"choicesjs\",\"hideLabel\":true,\"tableView\":true,\"multiple\":true,\"indexeddb\":{\"database\":\"\",\"table\":\"\",\"filter\":{}},\"data\":{\"values\":[{\"label\":\"\",\"value\":\"\"}],\"headers\":[{\"key\":\"\",\"value\":\"\"}],\"json\":\"\",\"url\":\"\",\"resource\":\"\",\"custom\":\"\"},\"disableLimit\":false,\"selectThreshold\":0.3,\"addResource\":false,\"reference\":false,\"validate\":{\"select\":false,\"onlyAvailableItems\":false,\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"customConditional\":\"if(data.rdoResident === \\\"Only include the residents selected below\\\") {\\n  instance.disabled = false;\\n  component.redrawOn = \\\"rdoResident\\\";\\n} else {\\n  instance.disabled = true;\\n  component.redrawOn = \\\"rdoResident\\\";\\n}\",\"attributes\":{\"maxLength\":\"-1\"},\"key\":\"cmbInclude\",\"QuoteValuesLegacy\":false,\"SQLSource\":\"select distinct con.[Last] + ', ' + con.[First] as [text], con.ContactGUID as [value]\\nfrom [ct_program administration_Program_History] hist\\njoin [ct_program administration_Program_History_formgrid_program_enrollment] link on hist.__forminstanceguid = link.__forminstanceguid\\njoin [ct_program administration_program_enrollment] enroll on link.[view] = enroll.__forminstanceguid\\njoin Contact con on hist.__ownerobjectguid = con.ContactGUID\\nwhere enroll.cmbProgram = 'Community Residential'\\nand enroll.txtStartDateOfServivices <= cast(getdate() as date)\\nand (enroll.txtLastDateOfServivices >= cast(getdate() as date) \\n\\tor nullif(enroll.txtLastDateOfServivices, '1900-01-01') is null\\n\\tor datediff(day, cast(getdate() as date), enroll.txtLastDateOfServivices) between 0 and -90)\\norder by [text]\",\"type\":\"select\",\"inputMasks\":[{\"label\":\"\",\"mask\":\"\"}],\"input\":true,\"KEY\":\"cmbInclude\",\"hideOnChildrenHidden\":false,\"mask\":false,\"inputType\":\"text\",\"inputFormat\":\"plain\",\"spellcheck\":true,\"redrawOn\":\"rdoResident\",\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"validateOn\":\"change\",\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"idPath\":\"id\",\"clearOnRefresh\":false,\"limit\":100,\"dataSrc\":\"values\",\"valueProperty\":\"\",\"lazyLoad\":true,\"filter\":\"\",\"searchEnabled\":true,\"searchField\":\"\",\"minSearch\":0,\"readOnlyValue\":false,\"authenticate\":false,\"ignoreCache\":false,\"template\":\"<span>{{ item.label }}</span>\",\"selectFields\":\"\",\"searchThreshold\":0.3,\"uniqueOptions\":false,\"fuseOptions\":{\"include\":\"score\",\"threshold\":0.3},\"customOptions\":{},\"useExactSearch\":false,\"id\":\"etx9jq8\"},{\"label\":\"rdoResident2_NotForReporting\",\"optionsLabelPosition\":\"right\",\"inline\":false,\"hideLabel\":true,\"tableView\":false,\"values\":[{\"label\":\"Exclude the residents selected below\",\"value\":\"Exclude the residents selected below\",\"shortcut\":\"\"}],\"validate\":{\"onlyAvailableItems\":false,\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"key\":\"rdoResident2_NotForReporting\",\"type\":\"radio\",\"input\":true,\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"attributes\":{},\"validateOn\":\"change\",\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"inputType\":\"radio\",\"fieldSet\":false,\"id\":\"ehwxjz\"},{\"label\":\"cmbExclude\",\"widget\":\"choicesjs\",\"hideLabel\":true,\"tableView\":true,\"multiple\":true,\"indexeddb\":{\"database\":\"\",\"table\":\"\",\"filter\":{}},\"data\":{\"values\":[{\"label\":\"\",\"value\":\"\"}],\"headers\":[{\"key\":\"\",\"value\":\"\"}],\"json\":\"\",\"url\":\"\",\"resource\":\"\",\"custom\":\"\"},\"disableLimit\":false,\"selectThreshold\":0.3,\"addResource\":false,\"reference\":false,\"validate\":{\"select\":false,\"onlyAvailableItems\":false,\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"customConditional\":\"if(data.rdoResident === \\\"Exclude the residents selected below\\\") {\\n  instance.disabled = false;\\n  component.redrawOn = \\\"rdoResident\\\";\\n} else {\\n  instance.disabled = true;\\n  component.redrawOn = \\\"rdoResident\\\";\\n}\",\"attributes\":{\"maxLength\":\"-1\"},\"key\":\"cmbExclude\",\"QuoteValuesLegacy\":false,\"SQLSource\":\"select distinct con.[Last] + ', ' + con.[First] as [text], con.ContactGUID as [value]\\nfrom [ct_program administration_Program_History] hist\\njoin [ct_program administration_Program_History_formgrid_program_enrollment] link on hist.__forminstanceguid = link.__forminstanceguid\\njoin [ct_program administration_program_enrollment] enroll on link.[view] = enroll.__forminstanceguid\\njoin Contact con on hist.__ownerobjectguid = con.ContactGUID\\nwhere enroll.cmbProgram = 'Community Residential'\\nand enroll.txtStartDateOfServivices <= cast(getdate() as date)\\nand (enroll.txtLastDateOfServivices >= cast(getdate() as date) \\n\\tor nullif(enroll.txtLastDateOfServivices, '1900-01-01') is null\\n\\tor datediff(day, cast(getdate() as date), enroll.txtLastDateOfServivices) between 0 and -90)\\norder by [text]\",\"type\":\"select\",\"inputMasks\":[{\"label\":\"\",\"mask\":\"\"}],\"input\":true,\"KEY\":\"cmbExclude\",\"hideOnChildrenHidden\":false,\"mask\":false,\"inputType\":\"text\",\"inputFormat\":\"plain\",\"spellcheck\":true,\"redrawOn\":\"rdoResident\",\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"validateOn\":\"change\",\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"idPath\":\"id\",\"clearOnRefresh\":false,\"limit\":100,\"dataSrc\":\"values\",\"valueProperty\":\"\",\"lazyLoad\":true,\"filter\":\"\",\"searchEnabled\":true,\"searchField\":\"\",\"minSearch\":0,\"readOnlyValue\":false,\"authenticate\":false,\"ignoreCache\":false,\"template\":\"<span>{{ item.label }}</span>\",\"selectFields\":\"\",\"searchThreshold\":0.3,\"uniqueOptions\":false,\"fuseOptions\":{\"include\":\"score\",\"threshold\":0.3},\"customOptions\":{},\"useExactSearch\":false,\"id\":\"ekgd4w8\"},{\"label\":\"Generate Billing\",\"action\":\"custom\",\"isServerSideEvent\":false,\"showValidations\":false,\"custom\":\"var ct = 0;\\r\\nvar str = \\\"\\\";\\r\\nvar month = form.getComponent(\\\"cmbMonth\\\").getValue();\\r\\nvar year = form.getComponent(\\\"cmbYear\\\").getValue();\\r\\nvar residents = form.getComponent(\\\"rdoResident\\\").getValue();\\r\\nvar include = form.getComponent(\\\"cmbInclude\\\").getValue();\\r\\nvar exclude = form.getComponent(\\\"cmbExclude\\\").getValue();\\r\\n\\r\\nif(month === \\\"\\\" || month === null) {\\r\\n  ct += 1;\\r\\n  str += \\\"Select Month for billing record creation.\\\\n\\\";\\r\\n}\\r\\n\\r\\nif(year === \\\"\\\" || year === null) {\\r\\n  ct += 1;\\r\\n  str += \\\"Select Year for billing record creation.\\\\n\\\";\\r\\n}\\r\\n\\r\\nif(residents === \\\"\\\" || residents === null) {\\r\\n  ct += 1;\\r\\n  str += \\\"Select type of residents to include.\\\\n\\\";\\r\\n}\\r\\n\\r\\nif(residents === \\\"Only include the residents selected below\\\" && (include === \\\"\\\" || include === null || include.length == 0)) {\\r\\n  ct += 1;\\r\\n  str += \\\"Select residents to include.\\\\n\\\";\\r\\n}\\r\\n\\r\\nif(residents === \\\"Exclude the residents selected below\\\" && (exclude === \\\"\\\" || exclude === null || exclude.length == 0)) {\\r\\n  ct += 1;\\r\\n  str += \\\"Select residents to exclude.\\\\n\\\";\\r\\n}\\r\\n\\r\\n_getCustomData(\\\"cstm_fiscal admin_CR Form Extract_certificationQA\\\", { \\\"@month\\\": month , \\\"@year\\\": year }).then(function (data) {\\r\\n  $.each(data, function (i, x) {\\r\\n    if(x.certsMissing != \\\"\\\") {\\r\\n      ct += 1;\\r\\n      str += \\\"The following census certifications are missing for the selected month: \\\" + x.certsMissing + \\\"\\\\n\\\";\\r\\n    }\\r\\n  });\\r\\n\\r\\n\\r\\n  if(ct > 0) {\\r\\n    str = str.fontcolor('red');\\r\\n    form.getComponent(\\\"txtaGenerateError\\\").setValue(str);\\r\\n  } else {\\r\\n    form.getComponent(\\\"txtaGenerateError\\\").setValue(\\\"\\\");\\r\\n    form.getComponent(\\\"chkGenerateBilling\\\").setValue(true);\\r\\n    form.submit();\\r\\n  }\\r\\n});\\r\\n\\r\\n\",\"headers\":[{\"header\":\"\",\"value\":\"\"}],\"tableView\":false,\"key\":\"generateBilling\",\"CustomProperties\":[{\"Key\":\"\",\"Value\":\"\"}],\"type\":\"button\",\"input\":true,\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":false,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":true,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":{\"type\":\"input\"},\"attributes\":{},\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"size\":\"md\",\"leftIcon\":\"\",\"rightIcon\":\"\",\"block\":false,\"disableOnInvalid\":false,\"theme\":\"primary\",\"id\":\"egz6kjv\"}],\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"hideLabel\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"allowMultipleMasks\":false,\"tree\":false,\"id\":\"ekak8k\"},{\"label\":\"txtaGenerateError\",\"autoExpand\":false,\"isUploadEnabled\":false,\"inputMasks\":[{\"label\":\"\",\"mask\":\"\"}],\"hideLabel\":true,\"disabled\":true,\"tableView\":true,\"customConditional\":\"if(data.txtaGenerateError === \\\"\\\" || data.txtaGenerateError === null) {\\n  show = false;\\n} else {\\n  show = true;\\n}\",\"key\":\"txtaGenerateError\",\"type\":\"textarea\",\"input\":true,\"hideOnChildrenHidden\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":true,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"tabindex\":\"\",\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":{\"type\":\"input\"},\"attributes\":{},\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false,\"minLength\":\"\",\"maxLength\":\"\",\"pattern\":\"\",\"minWords\":\"\",\"maxWords\":\"\"},\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"mask\":false,\"inputType\":\"text\",\"inputFormat\":\"plain\",\"inputMask\":\"\",\"spellcheck\":true,\"rows\":3,\"wysiwyg\":false,\"editor\":\"\",\"fixedSize\":true,\"id\":\"eibk1ht\"}],\"width\":6,\"offset\":0,\"push\":0,\"pull\":0,\"size\":\"md\"},{\"components\":[],\"width\":6,\"offset\":0,\"push\":0,\"pull\":0,\"size\":\"md\"}],\"key\":\"columns\",\"type\":\"columns\",\"input\":false,\"tableView\":false,\"placeholder\":\"\",\"prefix\":\"\",\"customClass\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":false,\"hidden\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"modalEdit\":false,\"dataGridLabel\":false,\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"tooltip\":\"\",\"hideLabel\":false,\"tabindex\":\"\",\"disabled\":false,\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"attributes\":{},\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"conditional\":{\"show\":null,\"when\":null,\"eq\":\"\"},\"overlay\":{\"style\":\"\",\"left\":\"\",\"top\":\"\",\"width\":\"\",\"height\":\"\"},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"properties\":{},\"allowMultipleMasks\":false,\"tree\":false,\"autoAdjust\":false,\"hideOnChildrenHidden\":false,\"id\":\"eidczqx\"}],\"placeholder\":\"\",\"prefix\":\"\",\"suffix\":\"\",\"multiple\":false,\"defaultValue\":null,\"protected\":false,\"unique\":false,\"persistent\":false,\"clearOnHide\":false,\"refreshOn\":\"\",\"redrawOn\":\"\",\"labelPosition\":\"top\",\"description\":\"\",\"errorLabel\":\"\",\"autofocus\":false,\"dbIndex\":false,\"customDefaultValue\":\"\",\"calculateValue\":\"\",\"calculateServer\":false,\"widget\":null,\"validateOn\":\"change\",\"validate\":{\"required\":false,\"custom\":\"\",\"customPrivate\":false,\"strictDateValidation\":false,\"multiple\":false,\"unique\":false},\"allowCalculateOverride\":false,\"encrypted\":false,\"showCharCount\":false,\"showWordCount\":false,\"allowMultipleMasks\":false,\"tree\":false,\"id\":\"eknhf2b\"}]}","FormIOTemplateBackup":"","IsMinimizeTemplate":false,"FormType":1,"FormViewId":1757682067,"TableName":"[dbo].[ct_Fiscal Admin_Community Residential Form Extract]","Source":1,"SourceName":"DirectToSQL","FormScripts":"{\"ServerScript\":\"Class FormScriptEvents\\r\\nprivate sub OnCreate()\\r\\n\\r\\nend sub\\r\\nprivate sub OnLoad()\\r\\n    clearFields()\\r\\n    theForm(\\\"txtaDebug\\\") = \\\"\\\"\\r\\n    theForm(\\\"txtaGenerateError\\\") = \\\"\\\"\\r\\nend sub\\r\\nprivate sub OnSave()\\r\\n    if theForm(\\\"chkGenerateBilling\\\") then\\r\\n        select case theForm(\\\"cmbProgram\\\")\\r\\n            case \\\"Community Residential\\\"\\r\\n                'run the extract for Community Residential\\r\\n                createCRAppts()\\r\\n            case \\\"Community Residential - Room & Board\\\"\\r\\n                'code for case 2\\r\\n                createCRRBAppts()\\r\\n            case \\\"Intermediate Care Facilities\\\"\\r\\n                'code for case 3\\r\\n                theForm(\\\"txtaGenerateError\\\") = \\\"<font color='red'>No billing records were created, not yet configured</font>\\\"\\r\\n        end select\\r\\n    \\r\\n        theForm(\\\"chkGenerateBilling\\\") = false\\r\\n    end if\\r\\nend sub\\r\\nprivate sub clearFields()\\r\\n    theForm(\\\"cmbMonth\\\") = \\\"\\\"\\r\\n    theForm(\\\"cmbYear\\\") = \\\"\\\"\\r\\n    theForm(\\\"cmbInclude\\\") = \\\"\\\"\\r\\n    theForm(\\\"cmbExclude\\\") = \\\"\\\"\\r\\n    theForm(\\\"rdoResident1_NotForReporting\\\") = \\\"\\\"\\r\\n    theForm(\\\"rdoResident2_NotForReporting\\\") = \\\"\\\"\\r\\n    theForm(\\\"rdoResident\\\") = \\\"\\\"\\r\\n    theForm(\\\"cmbProgram\\\") = \\\"\\\"\\r\\nend sub\\r\\nprivate sub createCRAppts()\\r\\n    resType = \\\"\\\"\\r\\n    residents = \\\"\\\"\\r\\n    if theForm(\\\"rdoResident\\\") = \\\"All residents active during the billing period\\\" then\\r\\n        resType = \\\"All\\\"\\r\\n    elseif theForm(\\\"rdoResident\\\") = \\\"Only include the residents selected below\\\" then\\r\\n        resType = \\\"Include\\\"\\r\\n        residents = theForm(\\\"cmbInclude\\\")\\r\\n    elseif theForm(\\\"rdoResident\\\") = \\\"Exclude the residents selected below\\\" then\\r\\n        resType = \\\"Exclude\\\"\\r\\n        residents = theForm(\\\"cmbExclude\\\")\\r\\n    end if\\r\\n\\r\\n    'both queries make sure that they don't create duplicate reports\\r\\n    eligible = theForm.execSQL(\\\"exec [cstm_fiscal admin_CR Form Extract_getValidDays] @month = '\\\" & theForm(\\\"cmbMonth\\\") & \\\"', @year = '\\\" & theForm(\\\"cmbYear\\\") & \\\"', @resType = '\\\" & resType & \\\"', @residents = '\\\" & residents & \\\"'\\\")\\r\\n    ineligible = theForm.execSQL(\\\"exec [cstm_fiscal admin_CR Form Extract_getIneligibleDays] @month = '\\\" & theForm(\\\"cmbMonth\\\") & \\\"', @year = '\\\" & theForm(\\\"cmbYear\\\") & \\\"', @resType = '\\\" & resType & \\\"', @residents = '\\\" & residents & \\\"'\\\")\\r\\n    createString = \\\"\\\"\\r\\n    user = theForm.User.UserGUID.tostring()\\r\\n    fig = theForm.FormInstanceGUID.tostring()\\r\\n    owner = theForm.DataStore.OwnerObjectGUID.tostring()\\r\\n\\r\\n    if eligible.Rows.Count > 0 then\\r\\n        for x = 0 to eligible.Rows.Count - 1\\r\\n            startDT = eligible.Rows(x).Item(\\\"startDT\\\")\\r\\n            endDT = eligible.Rows(x).Item(\\\"endDT\\\")\\r\\n            actGUID = eligible.Rows(x).Item(\\\"ActivityGUID\\\")\\r\\n            progGUID = eligible.Rows(x).Item(\\\"costCenterGUID\\\")\\r\\n            locGUID = eligible.Rows(x).Item(\\\"LocationGUID\\\")\\r\\n            residentGUID = eligible.Rows(x).Item(\\\"residentGUID\\\")\\r\\n            'user = theForm.User.UserGUID.tostring()\\r\\n            'fig = theForm.FormInstanceGUID.tostring()\\r\\n            expense = \\\"00000000-0000-0000-0000-000000000000\\\"\\r\\n\\r\\n            apptGUID = theForm.CreateAcctAppointment(startDT, endDT, actGUID, progGUID, locGUID, residentGUID, user, fig, expense)\\r\\n\\r\\n            theForm(\\\"txtaDebug\\\") = theForm(\\\"txtaDebug\\\") & vbnewline & \\\"eligible row: \\\" & x + 1 & \\\" was executed, apptguid: \\\" & apptGUID\\r\\n        next\\r\\n\\r\\n        createString = createString & \\\"<font color='blue'>All eligible records for contacts were created successfully.</font>\\\" & vbnewline\\r\\n\\r\\n        siteLogMessage = \\\"CR Form Extract Completed - With/Without Day\\\"\\r\\n        siteLogMonthAndYearInfo = \\\"Extracted for \\\" & theForm(\\\"cmbMonth\\\") & \\\"/\\\" & theForm(\\\"cmbYear\\\")\\r\\n        theForm.LogSomething user, \\\"41\\\", owner, fig, siteLogMessage, siteLogMonthAndYearInfo, \\\"\\\", \\\"\\\", \\\"\\\"\\r\\n    else\\r\\n        createString = createString & \\\"<font color='red'>All eligible records for contacts have been made for selected month and year (\\\" & theForm(\\\"cmbMonth\\\") & \\\"/\\\" & theForm(\\\"cmbYear\\\") & \\\").</font>\\\" & vbnewline\\r\\n    end if\\r\\n\\r\\n    if ineligible.Rows.Count > 0 then\\r\\n        for x = 0 to ineligible.Rows.Count - 1\\r\\n            startDT = ineligible.Rows(x).Item(\\\"startDT\\\")\\r\\n            endDT = ineligible.Rows(x).Item(\\\"endDT\\\")\\r\\n            actGUID = ineligible.Rows(x).Item(\\\"ActivityGUID\\\")\\r\\n            progGUID = ineligible.Rows(x).Item(\\\"costCenterGUID\\\")\\r\\n            locGUID = ineligible.Rows(x).Item(\\\"LocationGUID\\\")\\r\\n            residentGUID = ineligible.Rows(x).Item(\\\"residentGUID\\\")\\r\\n            'user = theForm.User.UserGUID.tostring()\\r\\n            'fig = theForm.FormInstanceGUID.tostring()\\r\\n            expense = \\\"00000000-0000-0000-0000-000000000000\\\"\\r\\n\\r\\n            apptGUID = theForm.CreateAcctAppointment(startDT, endDT, actGUID, progGUID, locGUID, residentGUID, user, fig, expense)\\r\\n\\r\\n            theForm(\\\"txtaDebug\\\") = theForm(\\\"txtaDebug\\\") & vbnewline & \\\"ineligible row: \\\" & x + 1 & \\\" was executed, apptguid: \\\" & apptGUID\\r\\n        next\\r\\n\\r\\n        createString = createString & \\\"<font color='blue'>All ineligible records for contacts were created successfully.</font>\\\" & vbnewline\\r\\n\\r\\n        siteLogMessage = \\\"CR Form Extract Completed - Ineligible\\\"\\r\\n        siteLogMonthAndYearInfo = \\\"Extracted for \\\" & theForm(\\\"cmbMonth\\\") & \\\"/\\\" & theForm(\\\"cmbYear\\\")\\r\\n        theForm.LogSomething user, \\\"41\\\", owner, fig, siteLogMessage, siteLogMonthAndYearInfo, \\\"\\\", \\\"\\\", \\\"\\\"\\r\\n    else\\r\\n        createString = createString & \\\"<font color='red'>All ineligible records for contacts have been made for selected month and year (\\\" & theForm(\\\"cmbMonth\\\") & \\\"/\\\" & theForm(\\\"cmbYear\\\") & \\\").</font>\\\" & vbnewline\\r\\n    end if\\r\\n\\r\\n    theForm(\\\"txtaGenerateError\\\") = createString\\r\\n    clearFields()\\r\\nend sub\\r\\nprivate sub createCRRBAppts()\\r\\n    resType = \\\"\\\"\\r\\n    residents = \\\"\\\"\\r\\n    if theForm(\\\"rdoResident\\\") = \\\"All residents active during the billing period\\\" then\\r\\n        resType = \\\"All\\\"\\r\\n    elseif theForm(\\\"rdoResident\\\") = \\\"Only include the residents selected below\\\" then\\r\\n        resType = \\\"Include\\\"\\r\\n        residents = theForm(\\\"cmbInclude\\\")\\r\\n    elseif theForm(\\\"rdoResident\\\") = \\\"Exclude the residents selected below\\\" then\\r\\n        resType = \\\"Exclude\\\"\\r\\n        residents = theForm(\\\"cmbExclude\\\")\\r\\n    end if\\r\\n\\r\\n    apptGUID = \\\"\\\"\\r\\n    startDt = \\\"\\\"\\r\\n    endDt = \\\"\\\"\\r\\n    activityGUID = theForm.execScalerSQL(\\\"select top 1 cast(ActivityGUID as varchar(36)) from Activity where ActivityName = 'Community Residential Room & Board'\\\")\\r\\n    programGUID = \\\"\\\" 'this is their placement location\\r\\n    locationGUID = theForm.execScalerSQL(\\\"select top 1 cast(LocationGUID as varchar(36)) from [Location] where LocationName = 'Group Home'\\\")\\r\\n    residentGUID = \\\"\\\"\\r\\n    staffGUID = theForm.User.UserGUID.tostring()\\r\\n    dur = 0\\r\\n    imperfect = \\\"\\\"\\r\\n\\r\\n    expenseGUID = theForm.execScalerSQL(\\\"select top 1 cast(ExpenseGuid as varchar(36)) from Expense where ExpenseName = 'Community Residential Room & Board'\\\")\\r\\n    \\r\\n    cons = theForm.execSQL(\\\"exec [cstm_fiscal admin_CR R&B Form Extract_Get Contacts for Appt Creation] @month = '\\\" & theForm(\\\"cmbMonth\\\") & \\\"', @year = '\\\" & theForm(\\\"cmbYear\\\") & \\\"', @resType = '\\\" & resType & \\\"', @residents = '\\\" & residents & \\\"'\\\")\\r\\n    if cons.Columns.Count > 0 then\\r\\n        for x = 0 to cons.Rows.Count - 1\\r\\n            'for each contact and placement they have, create an acctappt record\\r\\n            startDt = cons.Rows(x).Item(\\\"placeStart\\\")\\r\\n            endDt = cons.Rows(x).Item(\\\"placeEnd\\\")\\r\\n            programGUID = cons.Rows(x).Item(\\\"placeLoc\\\")\\r\\n            residentGUID = cons.Rows(x).Item(\\\"residentGUID\\\")\\r\\n\\r\\n            'will return as true if the billing month is imperfect in some way\\r\\n            'a special calculation for duration will need to run if the proc returns as true\\r\\n            imperfect = theForm.execScalerSQL(\\\"exec [cstm_fiscal admin_CR R&B Form Extract_Get Unbillable Status] @month = '\\\" & theForm(\\\"cmbMonth\\\") & \\\"', @year = '\\\" & theForm(\\\"cmbYear\\\") & \\\"', @contact = '\\\" & cons.Rows(x).Item(\\\"residentGUID\\\") & \\\"', @rowGUID = '\\\" & cons.Rows(x).Item(\\\"RowGUID\\\") & \\\"'\\\")\\r\\n\\r\\n            if imperfect = \\\"true\\\" then\\r\\n                dur = theForm.execScalerSQL(\\\"exec [cstm_fiscal admin_CR R&B Form Extract_Get Final Amount] @month = '\\\" & theForm(\\\"cmbMonth\\\") & \\\"', @year = '\\\" & theForm(\\\"cmbYear\\\") & \\\"', @contact = '\\\" & cons.Rows(x).Item(\\\"residentGUID\\\") & \\\"', @rowGUID = '\\\" & cons.Rows(x).Item(\\\"RowGUID\\\") & \\\"'\\\")\\r\\n            else\\r\\n                'this is for a \\\"perfect\\\" month, where there are no exceptions to mess up the charge\\r\\n                dur = theForm.execScalerSQL(\\\"select top 1 cast(main.numberAmountPaid as varchar(100)) as amt \\\" & _\\r\\n                                                \\\"from [ct_Consents and Acknowledgements_Room & Board Contracts-ICF & CLA] parent \\\" & _\\r\\n                                                \\\"join [ct_Consents and Acknowledgements_Room & Board Contracts-ICF & CLA_formgrid_Contract] link on parent.__forminstanceguid = link.__forminstanceguid \\\" & _\\r\\n                                                \\\"join [ct_Consents and Acknowledgements_Room & Board Contract-ICF & CLA] main on link.[view] = main.__forminstanceguid \\\" & _\\r\\n                                                \\\"where cast(main.__ownerobjectguid as varchar(36)) = '\\\" & cons.Rows(x).Item(\\\"residentGUID\\\") & \\\"' \\\" & _\\r\\n                                                \\\"order by cast(main.txtEffectiveDate as date) desc\\\")\\r\\n            end if\\r\\n\\r\\n            'create the appointment with John's function for creation that includes duration since we need to specially set it\\r\\n            'this sets all 3 fields of duration, charge, and client liability, instead of showing bad values for the last two from the original duration\\r\\n            apptGUID = theForm.CreateAcctAppointmentWithDuration(startDt, endDt, activityGUID, programGUID, locationGUID, residentGUID, staffGUID, dur, theForm.FormInstanceGUID.tostring(), expenseGUID)\\r\\n        next\\r\\n    end if\\r\\n\\r\\n    theForm(\\\"cmbMonth\\\") = \\\"\\\"\\r\\n    theForm(\\\"cmbYear\\\") = \\\"\\\"\\r\\n    theForm(\\\"cmbInclude\\\") = \\\"\\\"\\r\\n    theForm(\\\"cmbExclude\\\") = \\\"\\\"\\r\\n    theForm(\\\"rdoResident1_NotForReporting\\\") = \\\"\\\"\\r\\n    theForm(\\\"rdoResident2_NotForReporting\\\") = \\\"\\\"\\r\\n    theForm(\\\"rdoResident\\\") = \\\"\\\"\\r\\nend sub\\r\\nEnd Class\",\"scriptType\":1}","ExposedToUnicentric":false,"ExposedToPortal":false,"ScriptType":1,"FormProps":"{\"headerIcons\":[{\"webPageTarget\":\"\",\"iconClass\":\"\",\"buttonClass\":\"\",\"title\":\"\",\"exportFormat\":\"\",\"parameters\":{}}]}","Height":null,"Width":null,"CloseOnSave":false,"Hidden":false,"ClassicFormScript":"Option Strict Off\r\nImports Unicentric.Form\r\nImports System\r\nImports System.Collections\r\nImports System.Windows.Forms\r\nImports System.Web.Mail\r\nImports System.IO\r\nImports System.Data\r\nImports System.Data.SqlClient\r\n\r\nPublic Module CRFormExtract\r\n   Public WithEvents TheForm As Unicentric.Form.FormInstance\r\n\r\n\r\nEnd Module","ClassicFormScriptType":0,"IsDraftSave":false}